<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roommate Money Splitter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .container {
            max-width: 400px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
        }
        .roommate-list {
            text-align: left;
            margin-bottom: 10px;
        }
        button {
            margin-top: 10px;
            padding: 10px;
            width: 100%;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .expenses, .results {
            text-align: left;
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Roommate Money Splitter</h2>
    
    <label for="amount">Enter Amount:</label>
    <input type="number" id="amount" placeholder="Amount" step="0.01">
    
    <h3>Who should share this amount?</h3>

    <input type="checkbox" id="selectAll"> <label for="selectAll"><strong>Select All</strong></label>
    <input type="checkbox" id="selectNonVeg"> <label for="selectNonVeg"><strong>Non Veg</strong></label>
    <input type="checkbox" id="selectEgg"> <label for="selectEgg"><strong>Egg</strong></label>

    <div id="roommateList" class="roommate-list"></div>

    <button onclick="addExpense()">Add Expense</button>

    <h3>Expenses:</h3>
    <div id="expenseList" class="expenses"></div>

    <h3>Final Amounts:</h3>
    <div id="resultList" class="results"></div>

    <button id="showResultsBtn" class="hidden" onclick="showResults()">Show Final Results</button>
    <button id="clearResultsBtn" class="hidden" onclick="clearResults()">Clear Results</button>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const roommates = ["pavan", "sasi", "sundar", "ravi", "deekshith", "nagi", "nandith"];
        const nonVegGroup = ["pavan", "sasi", "ravi", "nandith"];
        const eggGroup = ["nagi", "pavan", "sasi", "ravi", "nandith"];
        
        let balances = {};
        let totalAmount = 0;

        roommates.forEach(name => balances[name] = 0);

        const roommateList = document.getElementById("roommateList");
        roommates.forEach((name, index) => {
            const div = document.createElement("div");
            div.innerHTML = `
                <input type="checkbox" id="roommate${index}" class="roommate-checkbox" value="${name}">
                <label for="roommate${index}">${name}</label>
            `;
            roommateList.appendChild(div);
        });

        // Function to update checkboxes
        function updateCheckboxSelection(names, isChecked) {
            document.querySelectorAll(".roommate-checkbox").forEach(cb => {
                if (names.includes(cb.value)) {
                    cb.checked = isChecked;
                }
            });
        }

        document.getElementById("selectAll").addEventListener("change", function () {
            const isChecked = this.checked;
            document.querySelectorAll(".roommate-checkbox").forEach(cb => cb.checked = isChecked);
            document.getElementById("selectNonVeg").checked = false;
            document.getElementById("selectEgg").checked = false;
        });

        document.getElementById("selectNonVeg").addEventListener("change", function () {
            updateCheckboxSelection(nonVegGroup, this.checked);
            document.getElementById("selectAll").checked = false;
        });

        document.getElementById("selectEgg").addEventListener("change", function () {
            updateCheckboxSelection(eggGroup, this.checked);
            document.getElementById("selectAll").checked = false;
        });

        window.addExpense = function () {
            const amount = parseFloat(document.getElementById("amount").value);
            const selectedRoommates = Array.from(document.querySelectorAll(".roommate-checkbox:checked")).map(cb => cb.value);
            
            if (isNaN(amount) || amount <= 0) {
                alert("Please enter a valid amount.");
                return;
            }
            if (selectedRoommates.length === 0) {
                alert("Please select at least one roommate.");
                return;
            }

            let splitAmount = amount / selectedRoommates.length;
            splitAmount = Math.round(splitAmount * 100) / 100;

            let totalSplit = splitAmount * selectedRoommates.length;
            let remainingAmount = Math.round((amount - totalSplit) * 100) / 100;

            selectedRoommates.forEach((name, index) => {
                balances[name] += splitAmount;
                if (index === 0) {
                    balances[name] += remainingAmount;
                }
            });

            totalAmount += amount;

            const expenseList = document.getElementById("expenseList");
            const expenseItem = document.createElement("div");
            expenseItem.textContent = `Item: $${amount.toFixed(2)}`;
            expenseList.appendChild(expenseItem);

            document.getElementById("amount").value = "";
            document.querySelectorAll(".roommate-checkbox").forEach(cb => cb.checked = false);
            document.getElementById("selectAll").checked = false;
            document.getElementById("selectNonVeg").checked = false;
            document.getElementById("selectEgg").checked = false;

            document.getElementById("showResultsBtn").classList.remove("hidden");
        };

        window.showResults = function () {
            const resultList = document.getElementById("resultList");
            resultList.innerHTML = "";

            for (const [name, total] of Object.entries(balances)) {
                const resultItem = document.createElement("div");
                resultItem.textContent = `${name}: $${total.toFixed(2)}`;
                resultList.appendChild(resultItem);
            }

            const totalDiv = document.createElement("div");
            totalDiv.innerHTML = `<strong>Total: $${totalAmount.toFixed(2)}</strong>`;
            resultList.appendChild(totalDiv);

            document.getElementById("showResultsBtn").classList.add("hidden");
            document.getElementById("clearResultsBtn").classList.remove("hidden");
        };

        window.clearResults = function () {
            location.reload();
        };
    });
</script>

</body>
</html>
